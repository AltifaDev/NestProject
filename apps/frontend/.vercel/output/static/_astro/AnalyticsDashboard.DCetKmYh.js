import{j as a}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.CRC3r6US.js";import{p as j,P as h}from"./payload-client.Bgp2zVY_.js";import{L as N}from"./loader-circle.Bn9BaOCc.js";import{A as w,a as y}from"./arrow-down-right.DT0oj8Rx.js";import{H as k}from"./house.CZRoVNwI.js";import{E as z}from"./eye.BgHBTpqe.js";import{A as x}from"./arrow-up-right.zAr7Ea9V.js";import{c as L}from"./createLucideIcon.BistqCsR.js";import{T as A}from"./trending-up.DzlvFEhV.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],D=L("users",R);function H(){const[g,b]=n.useState(!0),[e,f]=n.useState({totalProperties:0,totalViews:0,newLeads:0,activeLeads:0,conversionRate:0});return n.useEffect(()=>{(async()=>{const r=j.getUser();if(!r||r.role!=="agent"||!r.agent)return;const l=typeof r.agent=="object"?r.agent.id:r.agent;try{const t=await(await fetch(`${h}/api/properties?where[agent][equals]=${l}&limit=1000`,{headers:{Authorization:`JWT ${localStorage.getItem("payload_token")}`}})).json(),v=t.totalDocs||0;let c=0;t.docs&&t.docs.forEach(s=>{c+=s.view_count||0});const i=await(await fetch(`${h}/api/leads?where[agent][equals]=${l}&limit=1000`,{headers:{Authorization:`JWT ${localStorage.getItem("payload_token")}`}})).json();let o=0,m=0,p=0;i.docs&&i.docs.forEach(s=>{s.status==="new"&&o++,["new","contacted","viewing","negotiating"].includes(s.status)&&m++,s.status==="closed_won"&&p++});const u=i.totalDocs>0?Math.round(p/i.totalDocs*100):0;f({totalProperties:v,totalViews:c,newLeads:o,activeLeads:m,conversionRate:u})}catch(d){console.error("Failed to fetch analytics",d)}finally{b(!1)}})()},[]),g?a.jsxs("div",{className:"ana-loading",children:[a.jsx(N,{className:"animate-spin"})," Loading Analytics Data..."]}):a.jsxs("div",{className:"ana-container",children:[a.jsxs("div",{className:"ana-header",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"ana-title",children:"Performance Analytics"}),a.jsx("p",{className:"ana-description",children:"Monitor your property portfolio and lead engagement."})]}),a.jsxs("div",{className:"ana-badge",children:[a.jsx(w,{size:16})," Data is calculated in real-time"]})]}),a.jsxs("div",{className:"ana-grid",children:[a.jsxs("div",{className:"ana-card",children:[a.jsx("div",{className:"ana-card-icon bg-blue-500/10 text-blue-500",children:a.jsx(k,{size:22})}),a.jsxs("div",{className:"ana-card-info",children:[a.jsx("p",{className:"ana-card-label",children:"Active Properties"}),a.jsx("h3",{className:"ana-card-value",children:e.totalProperties})]})]}),a.jsxs("div",{className:"ana-card",children:[a.jsx("div",{className:"ana-card-icon bg-purple-500/10 text-purple-500",children:a.jsx(z,{size:22})}),a.jsxs("div",{className:"ana-card-info",children:[a.jsx("p",{className:"ana-card-label",children:"Total Portfolio Views"}),a.jsxs("div",{className:"ana-value-row",children:[a.jsx("h3",{className:"ana-card-value",children:e.totalViews.toLocaleString()}),a.jsxs("span",{className:"ana-trend positive",children:[a.jsx(x,{size:14})," 12%"]})]})]})]}),a.jsxs("div",{className:"ana-card",children:[a.jsx("div",{className:"ana-card-icon bg-yellow-500/10 text-yellow-500",children:a.jsx(D,{size:22})}),a.jsxs("div",{className:"ana-card-info",children:[a.jsx("p",{className:"ana-card-label",children:"Active Leads"}),a.jsxs("div",{className:"ana-value-row",children:[a.jsx("h3",{className:"ana-card-value",children:e.activeLeads}),a.jsxs("span",{className:"ana-badge-small",children:[e.newLeads," new"]})]})]})]}),a.jsxs("div",{className:"ana-card",children:[a.jsx("div",{className:"ana-card-icon bg-green-500/10 text-green-500",children:a.jsx(A,{size:22})}),a.jsxs("div",{className:"ana-card-info",children:[a.jsx("p",{className:"ana-card-label",children:"Conversion Rate"}),a.jsxs("div",{className:"ana-value-row",children:[a.jsxs("h3",{className:"ana-card-value",children:[e.conversionRate,"%"]}),e.conversionRate>=10?a.jsxs("span",{className:"ana-trend positive",children:[a.jsx(x,{size:14})," Good"]}):a.jsxs("span",{className:"ana-trend",children:[a.jsx(y,{size:14})," Avg"]})]})]})]})]}),a.jsxs("div",{className:"ana-charts-grid",children:[a.jsxs("div",{className:"ana-chart-card",children:[a.jsx("h3",{className:"ana-chart-title",children:"Views over time (Last 30 Days)"}),a.jsxs("div",{className:"ana-chart-placeholder",children:[a.jsx("div",{className:"ana-bar-wrapper",children:a.jsx("div",{className:"ana-bar",style:{height:"30%"}})}),a.jsx("div",{className:"ana-bar-wrapper",children:a.jsx("div",{className:"ana-bar",style:{height:"50%"}})}),a.jsx("div",{className:"ana-bar-wrapper",children:a.jsx("div",{className:"ana-bar",style:{height:"40%"}})}),a.jsx("div",{className:"ana-bar-wrapper",children:a.jsx("div",{className:"ana-bar",style:{height:"70%"}})}),a.jsx("div",{className:"ana-bar-wrapper",children:a.jsx("div",{className:"ana-bar",style:{height:"60%"}})}),a.jsx("div",{className:"ana-bar-wrapper",children:a.jsx("div",{className:"ana-bar",style:{height:"90%"}})}),a.jsx("div",{className:"ana-bar-wrapper",children:a.jsx("div",{className:"ana-bar",style:{height:"80%"}})})]})]}),a.jsxs("div",{className:"ana-chart-card",children:[a.jsx("h3",{className:"ana-chart-title",children:"Lead Sources"}),a.jsxs("div",{className:"ana-chart-placeholder-circle",children:[a.jsx("div",{className:"ana-donut"}),a.jsxs("div",{className:"ana-legend",children:[a.jsxs("div",{className:"ana-legend-item",children:[a.jsx("span",{className:"ana-dot p-blue"})," Website"]}),a.jsxs("div",{className:"ana-legend-item",children:[a.jsx("span",{className:"ana-dot p-purple"})," Social"]}),a.jsxs("div",{className:"ana-legend-item",children:[a.jsx("span",{className:"ana-dot p-yellow"})," Referrals"]})]})]})]})]}),a.jsx("style",{children:`
                .ana-container { display: flex; flex-direction: column; gap: 1.5rem; width: 100%; max-width: 1200px; margin: 0 auto; }
                
                .ana-header { display: flex; justify-content: space-between; align-items: center; background: var(--bg-card); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border-subtle); flex-wrap: wrap; gap: 1rem; }
                .ana-title { font-size: 1.25rem; font-weight: 600; color: var(--text-main); margin-bottom: 0.25rem; }
                .ana-description { font-size: 0.85rem; color: var(--text-muted); }
                
                .ana-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(16, 185, 129, 0.1); color: #10b981; padding: 0.4rem 0.75rem; border-radius: 99px; font-size: 0.75rem; font-weight: 500; border: 1px solid rgba(16, 185, 129, 0.2); }
                .ana-loading { padding: 4rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem; color: var(--text-muted); }

                .ana-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.25rem; }
                
                .ana-card { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 1.5rem; display: flex; align-items: center; gap: 1rem; transition: transform 0.2s; }
                .ana-card:hover { transform: translateY(-2px); border-color: var(--border-medium); }
                
                .ana-card-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
                
                .ana-card-info { display: flex; flex-direction: column; gap: 0.25rem; }
                .ana-card-label { font-size: 0.8rem; color: var(--text-muted); font-weight: 500; }
                .ana-value-row { display: flex; align-items: baseline; gap: 0.75rem; }
                .ana-card-value { font-size: 1.75rem; font-weight: 700; color: var(--text-main); margin: 0; line-height: 1; }
                
                .ana-trend { font-size: 0.75rem; font-weight: 600; display: inline-flex; align-items: center; gap: 0.1rem; color: var(--text-dim); }
                .ana-trend.positive { color: #10b981; }
                
                .ana-badge-small { font-size: 0.65rem; background: rgba(59, 130, 246, 0.1); color: #3b82f6; padding: 0.1rem 0.4rem; border-radius: 4px; font-weight: 600; text-transform: uppercase; }

                .ana-charts-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 1.25rem; margin-top: 0.5rem; }
                @media (max-width: 768px) { .ana-charts-grid { grid-template-columns: 1fr; } }
                
                .ana-chart-card { background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 1.5rem; }
                .ana-chart-title { font-size: 1rem; font-weight: 600; color: var(--text-main); margin-bottom: 1.5rem; }
                
                .ana-chart-placeholder { height: 200px; display: flex; align-items: flex-end; justify-content: space-between; padding-top: 2rem; border-bottom: 1px solid var(--border-subtle); gap: 1rem; }
                .ana-bar-wrapper { flex: 1; height: 100%; display: flex; align-items: flex-end; justify-content: center; }
                .ana-bar { width: 100%; max-width: 32px; background: linear-gradient(to top, rgba(59,130,246,0.2), rgba(59,130,246,0.8)); border-radius: 4px 4px 0 0; border: 1px solid rgba(59,130,246,0.5); border-bottom: none; transition: height 1s ease-out; }
                .ana-bar:hover { background: rgba(59,130,246,1); }

                .ana-chart-placeholder-circle { height: 200px; display: flex; align-items: center; justify-content: center; gap: 2rem; }
                .ana-donut { width: 120px; height: 120px; border-radius: 50%; border: 20px solid var(--border-subtle); border-top-color: #3b82f6; border-right-color: #8b5cf6; border-bottom-color: #eab308; transform: rotate(-45deg); }
                .ana-legend { display: flex; flex-direction: column; gap: 0.75rem; }
                .ana-legend-item { display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; color: var(--text-muted); }
                .ana-dot { width: 10px; height: 10px; border-radius: 50%; }
                .p-blue { background: #3b82f6; }
                .p-purple { background: #8b5cf6; }
                .p-yellow { background: #eab308; }
            `})]})}export{H as default};
