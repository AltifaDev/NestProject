const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/leaflet-src.DKcHSrZ8.js","_astro/index.CRC3r6US.js"])))=>i.map(i=>d[i]);
import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.CRC3r6US.js";import{X as U,g as we,b as O,L as je,f as V,W as ke,D as Ne,S as Y,c as ie,F as _e,T as ze,R as Ce,a as Se,d as Me,e as Ae,B as oe,C as Le,_ as Ie}from"./preload-helper.HndiKp98.js";import{g as v}from"./index.CB87Sc6I.js";import{a as D,H as Q,C as Te}from"./heart.ySs17WGa.js";import{C as $e}from"./check.BcOmL8nZ.js";import{c as w}from"./createLucideIcon.BistqCsR.js";import{M as ee,P as Pe}from"./phone.BsnclMWD.js";import{H as W}from"./house.CZRoVNwI.js";import{C as Be}from"./clock.CgxgpKB4.js";import{E as re}from"./eye.BgHBTpqe.js";import{M as F}from"./map-pin.CAUsXeja.js";import{B as Ee,R as Re}from"./ruler.DZ1oY-KB.js";import{L as qe}from"./loader-circle.Bn9BaOCc.js";import{M as We}from"./mail.DTe58eKs.js";import{T as Fe}from"./trending-up.DzlvFEhV.js";import{c as Ve}from"./index.BbNJ08op.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Ue=w("arrow-up",He);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]],Ge=w("bed",De);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],te=w("circle-check",Oe);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Xe=w("external-link",Ye);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Je=w("graduation-cap",Ze);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Qe=w("hash",Ke);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],tt=w("maximize-2",et);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],st=w("plane",at);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],ot=w("share-2",it);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],ae=w("shopping-cart",rt);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["path",{d:"M20 9V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3",key:"1dgpiv"}],["path",{d:"M2 16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a2 2 0 0 0-4 0v1.5a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5V11a2 2 0 0 0-4 0z",key:"xacw8m"}],["path",{d:"M4 18v2",key:"jwo5n2"}],["path",{d:"M20 18v2",key:"1ar1qi"}],["path",{d:"M12 4v9",key:"oqhhn3"}]],lt=w("sofa",nt);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 17V7h4a3 3 0 0 1 0 6H9",key:"1dfk2c"}]],dt=w("square-parking",ct);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],se=w("stethoscope",mt);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],ht=w("store",pt);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["rect",{width:"16",height:"16",x:"4",y:"3",rx:"2",key:"1wxw4b"}],["path",{d:"M4 11h16",key:"mpoxn0"}],["path",{d:"M12 3v8",key:"1h2ygw"}],["path",{d:"m8 19-2 3",key:"13i0xs"}],["path",{d:"m18 22-2-3",key:"1p0ohu"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M16 15h.01",key:"rnfrdf"}]],gt=w("tram-front",xt);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ft=w("zap",ut),bt=[{key:"furniture",label:"Furniture",icon:lt},{key:"air_con",label:"Air Conditioning",icon:ke},{key:"water_heater",label:"Water Heater",icon:Ne},{key:"digital_lock",label:"Digital Lock",icon:Y},{key:"bathtub",label:"Bathtub",icon:ie},{key:"stove",label:"Electric/Gas Stove",icon:_e},{key:"tv",label:"Television",icon:ze},{key:"refrigerator",label:"Refrigerator",icon:Ce},{key:"internet",label:"Internet",icon:Se},{key:"smart_home",label:"Smart Home",icon:ft}],vt=[{key:"lift",label:"Elevator",icon:V},{key:"parking_facility",label:"Parking",icon:dt},{key:"pool",label:"Swimming Pool",icon:ie},{key:"gym",label:"Gym",icon:Me},{key:"cctv",label:"CCTV",icon:re},{key:"security",label:"24h Security",icon:Y},{key:"garden",label:"Garden/Green Area",icon:Ae},{key:"storage",label:"Storage Room",icon:oe}],yt={train:gt,car:O,airport:st,mall:ht,market:ae,supermarket:ae,school:Je,university:V,hospital:se,clinic:se},wt={transport:"bg-blue-100 text-blue-600",shop:"bg-orange-100 text-orange-600",edu:"bg-emerald-100 text-emerald-600",hosp:"bg-rose-100 text-rose-600"},jt={agent:"Real Estate Agent",senior_agent:"Senior Agent",broker:"Broker",consultant:"Property Consultant",sales_manager:"Sales Manager"};function kt({property:t,isOpen:i,onClose:s}){const c=n.useRef(null),p=n.useRef(null),f=n.useRef(null),r=n.useRef(null),N=n.useRef(null),_=n.useRef(null),h=n.useRef(null),[x,g]=n.useState("indoor"),[l,u]=n.useState("transport"),[b,M]=n.useState(0),[j,C]=n.useState(!1),[R,o]=n.useState(!1),[y,z]=n.useState(!1),[S,A]=n.useState(!1),[m,L]=n.useState({name:"",phone:"",email:"",message:""}),[q,T]=n.useState(!1),[$,X]=n.useState(!1);if(n.useEffect(()=>{const a=r.current;if(!a)return;const d=()=>{N.current&&(a.scrollTop>400?v.to(N.current,{opacity:1,y:0,pointerEvents:"auto",duration:.3}):v.to(N.current,{opacity:0,y:10,pointerEvents:"none",duration:.3}))};return a.addEventListener("scroll",d),()=>a.removeEventListener("scroll",d)},[i]),n.useEffect(()=>{if(!(!c.current||!p.current||!f.current)){if(i){const a=window.innerWidth-document.documentElement.clientWidth;document.body.style.overflow="hidden",document.body.style.paddingRight=`${a}px`,document.documentElement.style.overflow="hidden",v.set(c.current,{visibility:"visible",opacity:1,pointerEvents:"auto",display:"flex"}),v.fromTo(f.current,{opacity:0},{opacity:1,duration:.4}),v.fromTo(p.current,{y:30,opacity:0,scale:.98},{y:0,opacity:1,scale:1,duration:.5,ease:"power3.out"}),r.current&&(r.current.scrollTop=0),M(0)}else v.to(f.current,{opacity:0,duration:.3}),v.to(p.current,{y:20,opacity:0,scale:.98,duration:.3}),v.to(c.current,{opacity:0,duration:.3,onComplete:()=>{v.set(c.current,{visibility:"hidden",display:"none",pointerEvents:"none"}),document.body.style.overflow="",document.body.style.paddingRight="",document.documentElement.style.overflow=""}});return()=>{document.body.style.overflow="",document.body.style.paddingRight="",document.documentElement.style.overflow=""}}},[i]),n.useEffect(()=>{if(!_.current||!i)return;const a=_.current.children;a.length!==0&&v.fromTo(a,{y:15,opacity:0,scale:.95},{y:0,opacity:1,scale:1,duration:.4,stagger:.04,ease:"power2.out",overwrite:!0})},[x,i]),n.useEffect(()=>{if(!h.current||!i)return;const a=h.current.children;a.length!==0&&v.fromTo(a,{x:-10,opacity:0},{x:0,opacity:1,duration:.3,stagger:.05,ease:"power2.out",overwrite:!0})},[l,i]),!t)return null;const P=a=>new Intl.NumberFormat("th-TH").format(a),ne=()=>{navigator.clipboard.writeText(window.location.href).then(()=>{o(!0),setTimeout(()=>o(!1),2e3)})},le=async a=>{if(a.preventDefault(),!!t){T(!0);try{const d="http://localhost:3000",B=typeof t.agent=="object"?t.agent?.id:t.agent,E=t.id?parseInt(t.id.toString(),10):null,K=B?parseInt(B.toString(),10):null;(await fetch(`${d}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m.name,email:m.email,phone:m.phone,message:m.message||`I am interested in ${t.title}`,property:Number.isNaN(E)?null:E,agent:Number.isNaN(K)?null:K,source:"website",status:"new"})})).ok?(X(!0),setTimeout(()=>{A(!1),X(!1),L({name:"",phone:"",email:"",message:""})},3e3)):alert("Failed to send message. Please try again.")}catch(d){console.error(d),alert("An error occurred while sending your message.")}finally{T(!1)}}},ce=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}},k=[t.thumbnail,...t.images||[]].filter(Boolean),de=a=>t.indoor_amenities?!!t.indoor_amenities[a]:t.amenities&&t.amenities.length>0?t.amenities.some(d=>d.toLowerCase().includes(a.replace("_"," "))||d.toLowerCase().includes(a)):!1,me=a=>t.project_amenities?!!t.project_amenities[a]:t.amenities&&t.amenities.length>0?t.amenities.some(d=>d.toLowerCase().includes(a.replace("_"," "))||d.toLowerCase().includes(a)):!1,H=t.nearby_places||[],Z=H.filter(a=>a.category===l),pe=a=>H.some(d=>d.category===a),J=t.id?t.id.slice(0,8).toUpperCase():"N/A",he=t.view_count||0,xe=ce(t.updatedAt),ge=t.agent?.name||"Nest Team",ue=t.agent?.role?jt[t.agent.role]||t.agent.role:"Real Estate Agent",fe=t.agent?.image_url||"https://zskakdqvjrkwkzzamlkg.supabase.co/storage/v1/object/public/Image/profile-image/ProfileImg.png",be=t.agent?.verified??!1,ve=({name:a,distance:d,icon:B,color:E})=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-white border border-slate-100 rounded-2xl hover:border-blue-200 hover:shadow-md transition-all group cursor-default",children:[e.jsx("div",{className:`w-11 h-11 rounded-xl ${E} flex items-center justify-center shrink-0 shadow-sm group-hover:scale-110 transition-transform`,children:e.jsx(B,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-bold text-slate-800 truncate",children:a}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[e.jsx(F,{size:12,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-semibold text-blue-500",children:d})]})]})]}),ye=[{label:"Listing ID",value:J},{label:"Project",value:t.project_name||"-"},{label:"Property Type",value:t.propertyType||"-"},{label:"Floors",value:t.floors?`${t.floors} Floors`:"-"},{label:"Bedrooms",value:t.bedrooms?`${t.bedrooms} Rooms`:"-"},{label:"Bathrooms",value:t.bathrooms?`${t.bathrooms} Rooms`:"-"},{label:"Living Area",value:t.livingArea?`${t.livingArea} sq.m.`:t.sqft?`${t.sqft} sq.m.`:"-"},{label:"Land Area",value:t.landArea?`${t.landArea} sq.wa`:"-"},{label:"Parking",value:t.parking!=null?`${t.parking} Cars`:"-"},{label:"Facing Direction",value:t.direction||"-"},{label:"Year Built",value:t.yearBuilt?`${t.yearBuilt}`:"-"},{label:"Tenure",value:t.ownership||"-"},{label:"Decoration",value:t.decoration||"-"},{label:"Common Fee",value:t.common_fee?`à¸¿ ${P(t.common_fee)} / sq.m.`:"-"}];return e.jsxs("div",{ref:c,id:"nest-fixed-modal-root",className:"fixed inset-0 z-[1000000] flex items-center justify-center p-0 md:p-4",style:{display:"none",visibility:"hidden",opacity:0,pointerEvents:"none"},onWheel:a=>a.stopPropagation(),children:[e.jsx("div",{ref:f,className:"absolute inset-0 bg-slate-950/50 backdrop-blur-lg",onClick:s,style:{pointerEvents:"auto"}}),e.jsxs("div",{ref:p,className:"pdm-container w-full max-w-[1400px] h-full md:h-[96vh] bg-[var(--bg-primary,#fff)] md:rounded-3xl shadow-[0_60px_120px_-20px_rgba(0,0,0,0.4)] relative flex flex-col z-10 overflow-hidden",style:{pointerEvents:"auto"},children:[e.jsxs("div",{className:"pdm-header flex items-center justify-between border-b border-slate-100 bg-white/98 backdrop-blur-md z-[100] flex-shrink-0 px-4 md:px-8",style:{minHeight:"56px"},children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",style:{marginLeft:"14px"},children:[e.jsx("button",{onClick:s,className:"group p-2 -ml-1 text-slate-700 hover:text-slate-900 transition-all active:scale-90 flex items-center justify-center rounded-full hover:bg-slate-100 flex-shrink-0","aria-label":"Close",children:e.jsx(U,{size:20,strokeWidth:2.5,className:"group-hover:rotate-90 transition-transform duration-300"})}),e.jsxs("nav",{className:"hidden md:flex items-center gap-1 text-xs text-slate-400 min-w-0",children:[e.jsx("span",{className:"hover:text-slate-600 cursor-pointer transition-colors",children:"Home"}),e.jsx(D,{size:12,className:"flex-shrink-0"}),e.jsx("span",{className:"hover:text-slate-600 cursor-pointer transition-colors",children:t.listingType==="sale"?"For Sale":"For Rent"}),e.jsx(D,{size:12,className:"flex-shrink-0"}),e.jsx("span",{className:"text-slate-600 font-medium truncate max-w-[200px]",children:t.title})]})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 flex-shrink-0",style:{marginLeft:"14px",marginRight:"14px"},children:[e.jsxs("button",{onClick:()=>z(!y),className:`pdm-header-btn flex items-center gap-2 border rounded-xl text-xs font-bold transition-all ${y?"border-rose-200 bg-rose-50 text-rose-500":"border-slate-200 text-slate-600 hover:bg-slate-50"}`,children:[e.jsx(Q,{size:15,strokeWidth:2.5,className:y?"fill-rose-500 text-rose-500":""}),e.jsx("span",{className:"hidden sm:inline",children:"Save"})]}),e.jsxs("button",{onClick:ne,className:"pdm-header-btn hidden sm:flex items-center gap-2 border border-slate-200 rounded-xl text-xs font-bold text-slate-600 hover:bg-slate-50 transition-all",children:[R?e.jsx($e,{size:15,strokeWidth:2.5,className:"text-emerald-500"}):e.jsx(ot,{size:15,strokeWidth:2.5}),e.jsx("span",{children:R?"Copied":"Share"})]}),e.jsxs("button",{onClick:()=>{A(!0);const a=document.querySelector(".pdm-sidebar-card");a&&a.scrollIntoView({behavior:"smooth",block:"center"})},className:"pdm-header-btn-primary flex items-center gap-2 bg-slate-900 text-white rounded-xl text-xs font-bold transition-all hover:bg-slate-700 active:scale-95",children:[e.jsx(ee,{size:15,strokeWidth:2.5}),e.jsx("span",{children:"Contact"})]})]})]}),e.jsxs("div",{ref:r,className:"flex-1 overflow-y-auto bg-white scroll-smooth",style:{overscrollBehavior:"contain",WebkitOverflowScrolling:"touch"},"data-lenis-prevent":!0,children:[e.jsx("div",{className:"pdm-gallery relative w-full bg-slate-100",style:{marginBottom:"14px"},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-0.5 h-[260px] md:h-[520px]",children:[e.jsxs("div",{className:"md:col-span-8 overflow-hidden relative cursor-pointer group",onClick:()=>C(!0),children:[k[0]?e.jsx("img",{src:k[0],className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105",alt:"Main"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-200",children:e.jsx(W,{size:48,className:"text-slate-400"})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 via-transparent to-transparent"}),e.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[e.jsx("span",{className:"pdm-badge-sale px-3 py-1.5 rounded-full text-xs font-bold text-white shadow-lg",children:t.listingType==="sale"?"Sale":"Rent"}),e.jsx("span",{className:"px-3 py-1.5 rounded-full bg-white/90 text-slate-700 text-xs font-bold shadow-lg",children:t.propertyType})]})]}),e.jsxs("div",{className:"hidden md:flex md:col-span-4 flex-col gap-0.5",children:[e.jsx("div",{className:"h-[50%] overflow-hidden relative cursor-pointer group",onClick:()=>{M(1),C(!0)},children:k[1]?e.jsx("img",{src:k[1],className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105",alt:"Gallery 1"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-200",children:e.jsx(W,{size:32,className:"text-slate-400"})})}),e.jsxs("div",{className:"h-[50%] flex gap-0.5",children:[e.jsx("div",{className:"w-1/2 overflow-hidden relative cursor-pointer group",onClick:()=>{M(2),C(!0)},children:k[2]?e.jsx("img",{src:k[2],className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105",alt:"Gallery 2"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-200",children:e.jsx(W,{size:24,className:"text-slate-400"})})}),e.jsxs("div",{className:"w-1/2 relative bg-slate-200 cursor-pointer group overflow-hidden",onClick:()=>C(!0),children:[k[3]?e.jsx("img",{src:k[3],className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110",alt:"Gallery 3"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-300"}),k.length>3&&e.jsx("div",{className:"absolute inset-0 bg-black/40 group-hover:bg-black/55 transition-colors flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx(tt,{size:20,className:"mx-auto mb-1"}),e.jsx("span",{className:"text-xs font-bold",children:"View All Photos"}),e.jsxs("div",{className:"text-lg font-black",children:[k.length," Photos"]})]})})]})]})]})]})}),e.jsx("div",{className:"pdm-body w-full !max-w-none",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 xl:gap-12 items-start pt-8 pb-16",children:[e.jsxs("div",{className:"flex-1 min-w-0 space-y-0 ",children:[e.jsxs("div",{className:"pdm-title-section pb-8 border-b border-slate-100",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1.5 text-xs text-slate-400",style:{marginBottom:"14px"},children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Qe,{size:11}),e.jsxs("span",{children:["Listing ID: ",e.jsx("strong",{className:"text-slate-600",children:J})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Be,{size:11}),e.jsxs("span",{children:["Updated: ",e.jsx("strong",{className:"text-slate-600",children:xe})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(re,{size:11}),e.jsxs("span",{children:["Views: ",e.jsxs("strong",{className:"text-slate-600",children:[he.toLocaleString()," times"]})]})]}),t.rating&&e.jsxs("div",{className:"flex items-center gap-1 text-amber-500",children:[e.jsx(we,{size:11,className:"fill-amber-400"}),e.jsx("span",{className:"font-bold text-amber-600",children:t.rating})]})]}),e.jsx("h1",{className:"pdm-main-title text-slate-900 font-bold leading-tight",style:{marginBottom:"12px"},children:t.title}),e.jsxs("div",{className:"flex items-start gap-2 text-slate-500 text-sm",children:[e.jsx(F,{size:16,strokeWidth:2,className:"text-blue-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"leading-relaxed",children:t.address})]})]}),e.jsx("div",{className:"pdm-stats-bar flex flex-wrap gap-0 border-b border-slate-100",children:[{icon:Ge,label:"Bedrooms",value:t.bedrooms||"-"},{icon:Ee,label:"Bathrooms",value:t.bathrooms||"-"},{icon:Re,label:"sq.m.",value:t.livingArea||t.sqft||"-"},{icon:O,label:"Parking",value:t.parking!=null?t.parking:"-"},{icon:je,label:"Floors",value:t.floors||"-"}].map((a,d)=>e.jsxs("div",{className:"pdm-stat-item flex flex-col items-center justify-center gap-1 border-r border-slate-100 last:border-r-0",children:[e.jsx(a.icon,{size:18,strokeWidth:1.8,className:"text-blue-500"}),e.jsx("span",{className:"text-lg font-black text-slate-900 leading-none",children:a.value}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium uppercase tracking-wide",children:a.label})]},d))}),e.jsxs("div",{className:"pdm-section",children:[e.jsx("h2",{className:"pdm-section-title",children:"Description"}),e.jsx("p",{className:"text-slate-600 text-sm leading-[1.9] whitespace-pre-line",children:t.description||"No description available for this property."})]}),e.jsxs("div",{className:"pdm-section",children:[e.jsx("h2",{className:"pdm-section-title",children:"Details"}),e.jsx("div",{className:"pdm-specs-grid grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 p-6 bg-slate-50/50",children:ye.map((a,d)=>e.jsxs("div",{className:"flex justify-between items-center border-b border-slate-200 pb-2 last:border-0 md:last:border-b md:nth-last-child-2:border-0",children:[e.jsx("span",{className:"text-slate-500 text-sm font-medium",children:a.label}),e.jsx("span",{className:"text-slate-900 text-sm font-bold",children:a.value})]},d))})]}),e.jsxs("div",{className:"pdm-section",children:[e.jsx("h2",{className:"pdm-section-title",children:"Amenities"}),e.jsxs("div",{className:"flex gap-1 bg-slate-100 p-1 rounded-xl w-fit",style:{marginBottom:"28px"},children:[e.jsxs("button",{onClick:()=>g("indoor"),className:`pdm-tab ${x==="indoor"?"pdm-tab--active":""}`,children:[e.jsx(W,{size:14}),"Indoor"]}),e.jsxs("button",{onClick:()=>g("project"),className:`pdm-tab ${x==="project"?"pdm-tab--active":""}`,children:[e.jsx(V,{size:14}),"Project"]})]}),e.jsx("div",{ref:_,className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:(x==="indoor"?bt:vt).map(a=>{const d=x==="indoor"?de(a.key):me(a.key);return e.jsxs("div",{className:`pdm-amenity-item ${d?"pdm-amenity-item--active":"pdm-amenity-item--inactive"}`,children:[e.jsx(a.icon,{size:20,strokeWidth:1.8}),e.jsx("span",{className:"text-xs font-medium text-center leading-tight",children:a.label})]},a.key)})})]}),e.jsxs("div",{className:"pdm-section",children:[e.jsx("h2",{className:"pdm-section-title",children:"Location"}),e.jsx("div",{className:"pdm-map-container rounded-2xl overflow-hidden border border-slate-200",children:e.jsx("iframe",{title:"Property Location",width:"100%",height:"280",style:{border:0},loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",src:`https://www.google.com/maps?q=${t.lat||13.7563},${t.lng||100.5018}&z=15&output=embed`})}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 text-sm text-slate-500",children:[e.jsx(F,{size:14,className:"text-blue-400 flex-shrink-0"}),e.jsx("span",{children:t.address}),e.jsxs("a",{href:`https://www.google.com/maps?q=${t.lat||13.7563},${t.lng||100.5018}`,target:"_blank",rel:"noopener noreferrer",className:"ml-auto flex items-center gap-1 text-blue-500 hover:text-blue-700 font-medium text-xs transition-colors flex-shrink-0",children:[e.jsx(Xe,{size:12}),"Open in Google Maps"]})]})]}),H.length>0&&e.jsxs("div",{className:"pdm-section",children:[e.jsx("h2",{className:"pdm-section-title",children:"Nearby Places"}),e.jsx("div",{className:"flex flex-wrap gap-2.5",style:{marginBottom:"24px"},children:[{id:"transport",label:"Transport",icon:O,color:"text-blue-500",bg:"bg-blue-50"},{id:"shop",label:"Shopping",icon:oe,color:"text-orange-500",bg:"bg-orange-50"},{id:"edu",label:"Education",icon:V,color:"text-emerald-500",bg:"bg-emerald-50"},{id:"hosp",label:"Hospital",icon:Q,color:"text-rose-500",bg:"bg-rose-50"}].filter(a=>pe(a.id)).map(a=>e.jsxs("button",{onClick:()=>u(a.id),className:`px-5 py-2.5 rounded-xl text-xs font-bold transition-all flex items-center gap-2.5 border-2 ${l===a.id?"bg-slate-900 border-slate-900 text-white shadow-xl shadow-slate-200 -translate-y-0.5":"bg-white border-slate-100 text-slate-500 hover:border-slate-300 hover:text-slate-700"}`,children:[e.jsx(a.icon,{size:16,className:l===a.id?"text-white":a.color}),a.label]},a.id))}),e.jsx("div",{ref:h,className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Z.length>0?Z.map((a,d)=>{const B=yt[a.icon||""]||F,E=wt[a.category]||"bg-slate-100 text-slate-600";return e.jsx(ve,{name:a.name,distance:a.distance,icon:B,color:E},a.id||d)}):e.jsxs("div",{className:"col-span-full text-center text-sm text-slate-400 py-6",children:["No ",l," places listed for this property."]})})]})]}),e.jsxs("div",{className:"w-full lg:w-[360px] xl:w-[400px] flex-shrink-0 lg:sticky lg:top-6 flex flex-col",style:{gap:"32px"},children:[e.jsxs("div",{className:"pdm-sidebar-card",children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",style:{marginBottom:"4px"},children:t.listingType==="sale"?"Sale Price":"Rent / Month"}),e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsxs("span",{className:"text-3xl font-black text-blue-600 leading-none",children:["à¸¿ ",P(t.price)]})}),t.livingArea&&e.jsxs("div",{className:"text-xs text-slate-400 mt-2",children:["â‰ˆ à¸¿ ",P(Math.round(t.price/t.livingArea))," / sq.m."]})]}),S?e.jsxs("div",{className:"pdm-contact-form-container",children:[e.jsxs("div",{className:"pdm-contact-form-header",children:[e.jsx("h4",{className:"pdm-contact-form-title",children:"Send a Message"}),e.jsx("button",{onClick:()=>A(!1),className:"pdm-contact-form-close",children:e.jsx(U,{size:16})})]}),$?e.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-emerald-600 text-center",children:[e.jsx(te,{size:36,className:"mb-3"}),e.jsx("p",{className:"font-bold text-base",children:"Message Sent!"}),e.jsx("p",{className:"text-xs text-emerald-600/70 mt-1 leading-relaxed",children:"The agent has been notified and will contact you shortly."})]}):e.jsxs("form",{onSubmit:le,className:"pdm-contact-form",children:[e.jsx("input",{required:!0,type:"text",placeholder:"Your Name *",value:m.name,onChange:a=>L({...m,name:a.target.value}),className:"pdm-contact-input"}),e.jsx("input",{required:!0,type:"tel",placeholder:"Phone Number *",value:m.phone,onChange:a=>L({...m,phone:a.target.value}),className:"pdm-contact-input"}),e.jsx("input",{type:"email",placeholder:"Email Address",value:m.email,onChange:a=>L({...m,email:a.target.value}),className:"pdm-contact-input"}),e.jsx("textarea",{placeholder:"Hi, I am interested in this property...",value:m.message,onChange:a=>L({...m,message:a.target.value}),rows:3,className:"pdm-contact-textarea"}),e.jsx("button",{type:"submit",disabled:q,className:"pdm-contact-submit",children:q?e.jsx(qe,{size:16,className:"animate-spin"}):"Send Message"})]})]}):e.jsxs("div",{className:"flex flex-col",style:{gap:"12px",marginBottom:"24px"},children:[e.jsxs("a",{href:`tel:${t.agent?.phone||""}`,className:"pdm-cta-primary w-full flex items-center justify-center gap-2.5",children:[e.jsx(Pe,{size:17,strokeWidth:2.5}),e.jsx("span",{children:"Call"}),t.agent?.phone&&e.jsx("span",{className:"opacity-80 text-xs",children:t.agent.phone})]}),e.jsxs("button",{onClick:()=>A(!0),className:"pdm-cta-secondary w-full flex items-center justify-center gap-2.5",children:[e.jsx(ee,{size:17,strokeWidth:2.5}),e.jsx("span",{children:"Message"})]}),t.agent?.lineId&&e.jsxs("a",{href:`https://line.me/ti/p/${t.agent.lineId}`,target:"_blank",rel:"noopener noreferrer",className:"pdm-cta-line w-full flex items-center justify-center gap-2.5",children:[e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.281.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"})}),e.jsx("span",{children:"Contact via LINE"})]}),e.jsxs("a",{href:`mailto:${t.agent?.email||""}`,className:"pdm-cta-email w-full flex items-center justify-center gap-2.5",children:[e.jsx(We,{size:17,strokeWidth:2.5}),e.jsx("span",{children:"Send Email"})]})]}),e.jsx("div",{className:"h-px bg-slate-100",style:{marginBottom:"20px"}}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden bg-slate-100 flex-shrink-0 ring-2 ring-slate-100",children:e.jsx("img",{src:fe,className:"w-full h-full object-cover",alt:"Agent"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-slate-900 text-sm truncate",children:ge}),be&&e.jsxs("span",{className:"pdm-verified-badge",children:[e.jsx(te,{size:10}),"Verified"]})]}),e.jsx("span",{className:"text-xs text-slate-400",children:ue})]})]})]}),e.jsxs("div",{className:"pdm-sidebar-card",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",style:{marginBottom:"16px"},children:[e.jsx(Fe,{size:15,className:"text-blue-500"}),"Price Summary"]}),e.jsx("div",{className:"flex flex-col",style:{gap:"16px"},children:[{label:"Listing Price",value:`à¸¿ ${P(t.price)}`},{label:"Price per sq.m.",value:t.livingArea?`à¸¿ ${P(Math.round(t.price/t.livingArea))}`:"-"},{label:"Price per sq.wa",value:t.landArea?`à¸¿ ${P(Math.round(t.price/t.landArea))}`:"-"}].map((a,d)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-slate-500",children:a.label}),e.jsx("span",{className:"font-bold text-slate-800",children:a.value})]},d))})]}),e.jsxs("div",{className:"pdm-sidebar-card bg-slate-900 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3",style:{marginBottom:"12px"},children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center",children:e.jsx(Te,{size:18,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm",children:"Schedule a Tour"}),e.jsx("div",{className:"text-xs text-white/60",children:"Pick a date and time"})]})]}),e.jsx("button",{className:"w-full py-3 bg-white text-slate-900 rounded-xl font-bold text-sm hover:bg-slate-100 transition-colors active:scale-95",children:"Book a Tour"})]}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsxs("button",{className:"text-xs text-slate-400 hover:text-slate-600 underline flex items-center gap-1",children:[e.jsx(Y,{size:10}),"Report Listing"]})})]})]})})]}),e.jsx("button",{ref:N,onClick:()=>r.current?.scrollTo({top:0,behavior:"smooth"}),className:"fixed bottom-8 right-8 z-[100] w-12 h-12 bg-slate-900 text-white rounded-full flex items-center justify-center shadow-2xl hover:scale-110 active:scale-95 transition-transform",style:{opacity:0,pointerEvents:"none",transform:"translateY(10px)"},"aria-label":"Scroll to top",children:e.jsx(Ue,{size:20,strokeWidth:2.5})})]}),j&&k.length>0&&e.jsxs("div",{className:"fixed inset-0 z-[2000000] bg-black/95 flex flex-col",onClick:()=>C(!1),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 text-white",onClick:a=>a.stopPropagation(),children:[e.jsxs("span",{className:"text-sm font-medium opacity-70",children:[b+1," / ",k.length]}),e.jsx("button",{onClick:()=>C(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:e.jsx(U,{size:24})})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center relative px-4",onClick:a=>a.stopPropagation(),children:[e.jsx("button",{onClick:()=>M(a=>Math.max(0,a-1)),className:"absolute left-4 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",children:e.jsx(Le,{size:24})}),e.jsx("img",{src:k[b],className:"max-h-full max-w-full object-contain rounded-xl",alt:`Gallery ${b+1}`}),e.jsx("button",{onClick:()=>M(a=>Math.min(k.length-1,a+1)),className:"absolute right-4 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",children:e.jsx(D,{size:24})})]}),e.jsx("div",{className:"flex gap-2 p-4 overflow-x-auto justify-center",onClick:a=>a.stopPropagation(),children:k.map((a,d)=>e.jsx("div",{onClick:()=>M(d),className:`w-16 h-12 rounded-lg overflow-hidden flex-shrink-0 cursor-pointer transition-all ${d===b?"ring-2 ring-white scale-110":"opacity-50 hover:opacity-80"}`,children:e.jsx("img",{src:a,className:"w-full h-full object-cover",alt:`Thumb ${d}`})},d))})]}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        #nest-fixed-modal-root { overscroll-behavior: contain !important; }
        #nest-fixed-modal-root * { box-sizing: border-box !important; }

        /* Header buttons */
        .pdm-header-btn {
          padding: 7px 14px;
          height: 36px;
          white-space: nowrap;
        }
        .pdm-header-btn-primary {
          padding: 7px 16px;
          height: 36px;
          white-space: nowrap;
        }

        /* Gallery */
        .pdm-gallery { flex-shrink: 0; }

        /* Badge */
        .pdm-badge-sale {
          background: linear-gradient(135deg, #2563eb, #1d4ed8);
        }

        /* Stats Bar */
        .pdm-stats-bar {
          padding: 20px 0;
          margin-bottom: 0;
        }
        .pdm-stat-item {
          flex: 1;
          min-width: 60px;
          padding: 12px 8px;
        }

        /* Section */
        .pdm-section {
          padding-top: 32px;
          padding-bottom: 32px;
          border-bottom: 1px solid #f1f5f9;
        }
        .pdm-section:last-child { border-bottom: none; }
        .pdm-section-title {
          font-size: 1rem;
          font-weight: 800;
          color: #0f172a;
          margin-bottom: 20px;
          letter-spacing: -0.02em;
        }

        /* Title */
        .pdm-title-section { padding-top: 0; }
        .pdm-main-title {
          font-size: clamp(1.2rem, 2.5vw, 1.6rem);
          font-weight: 800;
          line-height: 1.3;
          color: #0f172a;
        }

        /* Specs Grid */
        .pdm-specs-grid {
          border-radius: 16px;
        }

        /* Tabs */
        .pdm-tab {
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 8px 16px;
          border-radius: 10px;
          font-size: 0.8125rem;
          font-weight: 600;
          color: #64748b;
          transition: all 0.2s;
          white-space: nowrap;
        }
        .pdm-tab:hover { color: #334155; }
        .pdm-tab--active {
          background: white;
          color: #1e40af;
          box-shadow: 0 1px 4px rgba(0,0,0,0.12);
        }

        /* Amenity Items */
        .pdm-amenity-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 8px;
          padding: 16px 8px;
          border-radius: 14px;
          border: 1.5px solid transparent;
          transition: all 0.2s;
          cursor: default;
        }
        .pdm-amenity-item--active {
          background: #eff6ff;
          border-color: #bfdbfe;
          color: #1d4ed8;
        }
        .pdm-amenity-item--inactive {
          background: #f8fafc;
          border-color: #f1f5f9;
          color: #cbd5e1;
        }

        /* Map */
        .pdm-map-container { background: #f1f5f9; }

        /* Nearby */
        .pdm-nearby-card {
          background: #f8fafc;
          border: 1px solid #e2e8f0;
          border-radius: 14px;
          padding: 14px 16px;
        }

        /* Contact Form */
        .pdm-contact-form-container {
          background-color: #f8fafc !important;
          padding: 20px !important;
          border-radius: 14px !important;
          border: 1px solid #e2e8f0 !important;
          display: flex !important;
          flex-direction: column !important;
          gap: 12px !important;
          margin-bottom: 24px !important;
        }
        .pdm-contact-form-header {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          margin-bottom: 4px !important;
        }
        .pdm-contact-form-title {
          font-weight: 700 !important;
          color: #1e293b !important;
          font-size: 0.875rem !important;
          margin: 0 !important;
        }
        .pdm-contact-form-close {
          color: #94a3b8 !important;
          background: none !important;
          border: none !important;
          padding: 4px !important;
          cursor: pointer !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          transition: color 0.2s !important;
        }
        .pdm-contact-form-close:hover {
          color: #475569 !important;
        }
        .pdm-contact-form {
          display: flex !important;
          flex-direction: column !important;
          gap: 12px !important;
          margin: 0 !important;
        }
        .pdm-contact-input {
          width: 100% !important;
          font-size: 0.875rem !important;
          padding: 12px 14px !important;
          border: 1px solid #e2e8f0 !important;
          border-radius: 10px !important; /* Force moderate roundness over pill */
          background-color: #ffffff !important;
          color: #0f172a !important;
          outline: none !important;
          transition: all 0.2s !important;
          min-height: 44px !important;
          height: auto !important;
          line-height: normal !important;
          box-sizing: border-box !important;
          margin: 0 !important;
        }
        .pdm-contact-input::placeholder {
          color: #94a3b8 !important;
        }
        .pdm-contact-input:focus {
          border-color: #3b82f6 !important;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15) !important;
        }
        .pdm-contact-textarea {
          width: 100% !important;
          font-size: 0.875rem !important;
          padding: 14px !important;
          border: 1px solid #e2e8f0 !important;
          border-radius: 10px !important; /* Force moderate roundness over pill */
          background-color: #ffffff !important;
          color: #0f172a !important;
          outline: none !important;
          transition: all 0.2s !important;
          min-height: 100px !important;
          resize: none !important;
          line-height: 1.5 !important;
          box-sizing: border-box !important;
          margin: 0 !important;
        }
        .pdm-contact-textarea::placeholder {
          color: #94a3b8 !important;
        }
        .pdm-contact-textarea:focus {
          border-color: #3b82f6 !important;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15) !important;
        }
        .pdm-contact-submit {
          width: 100% !important;
          background-color: #2563eb !important;
          color: white !important;
          font-weight: 700 !important;
          font-size: 0.875rem !important;
          padding: 14px 20px !important;
          border-radius: 10px !important; /* Force moderate roundness over pill */
          border: none !important;
          cursor: pointer !important;
          transition: all 0.2s !important;
          display: flex !important;
          justify-content: center !important;
          align-items: center !important;
          gap: 8px !important;
          min-height: 48px !important;
          margin-top: 4px !important;
          box-sizing: border-box !important;
          box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15) !important;
        }
        .pdm-contact-submit:hover:not(:disabled) {
          background-color: #1d4ed8 !important;
          transform: translateY(-1px) !important;
        }
        .pdm-contact-submit:disabled {
          opacity: 0.7 !important;
          cursor: not-allowed !important;
        }

        /* Sidebar */
        .pdm-sidebar-card {
          background: white;
          border: 1px solid #e2e8f0;
          border-radius: 20px;
          padding: 24px;
          box-shadow: 0 4px 24px rgba(0,0,0,0.06);
        }

        /* CTA Buttons */
        .pdm-cta-primary {
          padding: 16px 20px;
          background: #1d4ed8;
          color: white;
          border-radius: 12px;
          font-weight: 800;
          font-size: 0.9rem;
          transition: all 0.2s;
          text-decoration: none;
          display: flex;
        }
        .pdm-cta-primary:hover { background: #1e40af; transform: translateY(-1px); box-shadow: 0 8px 20px rgba(29,78,216,0.3); }
        .pdm-cta-primary:active { transform: scale(0.98); }

        .pdm-cta-secondary {
          padding: 14px 20px;
          background: white;
          color: #0f172a;
          border: 2px solid #e2e8f0;
          border-radius: 12px;
          font-weight: 700;
          font-size: 0.875rem;
          transition: all 0.2s;
          cursor: pointer;
        }
        .pdm-cta-secondary:hover { background: #f8fafc; border-color: #cbd5e1; }

        .pdm-cta-line {
          padding: 14px 20px;
          background: #06c755;
          color: white;
          border-radius: 12px;
          font-weight: 700;
          font-size: 0.875rem;
          transition: all 0.2s;
          cursor: pointer;
          border: none;
          text-decoration: none;
          display: flex;
        }
        .pdm-cta-line:hover { background: #05b34b; }

        .pdm-cta-email {
          padding: 14px 20px;
          background: white;
          color: #475569;
          border: 1.5px solid #e2e8f0;
          border-radius: 12px;
          font-weight: 600;
          font-size: 0.875rem;
          transition: all 0.2s;
          text-decoration: none;
          display: flex;
        }
        .pdm-cta-email:hover { background: #f8fafc; }

        /* Verified Badge */
        .pdm-verified-badge {
          display: inline-flex;
          align-items: center;
          gap: 3px;
          padding: 2px 7px;
          background: #dcfce7;
          color: #16a34a;
          border-radius: 999px;
          font-size: 10px;
          font-weight: 700;
          flex-shrink: 0;
        }

        /* Body padding */
        .pdm-body {
          padding-left: 24px;
          padding-right: 12px;
        }
        @media (min-width: 768px) {
          .pdm-body {
            padding-left: 48px;
            padding-right: 24px;
          }
        }
        @media (min-width: 1024px) {
          .pdm-body {
            padding-left: 80px;
            padding-right: 48px;
          }
        }
        @media (min-width: 1400px) {
          .pdm-body {
            padding-left: 100px;
            padding-right: 40px;
          }
        }
 
        @media (max-width: 768px) {
          .pdm-stat-item { padding: 10px 4px; }
          .pdm-section { padding-top: 24px; padding-bottom: 24px; }
          .pdm-sidebar-card { padding: 24px 20px; }
        }
 
        .pdm-sidebar-card {
           padding-top: 36px;
           padding-bottom: 36px;
        }
      `}})]})}function Nt(t){return t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(0)+"k":t.toString()}function _t({isOpen:t,onClose:i,searchResults:s,isLoading:c}){const p=n.useRef(null),[f,r]=n.useState(!1),[N,_]=n.useState(null),[h,x]=n.useState(null);console.log("ðŸ”„ SearchResultsModal state:",{isOpen:t,selectedProperty:h?.title});const g=n.useRef(null),l=n.useRef(null),u=n.useRef([]),[b,M]=n.useState(!1),j=n.useRef(s);n.useEffect(()=>{j.current=s},[s]);const C=s?.features?.map(o=>o.properties)||[];C.length>0,console.log("ðŸŽ¨ Render - isOpen:",t,"isLoading:",c,"properties:",C.length),n.useEffect(()=>{typeof window>"u"||Ie(()=>import("./leaflet-src.DKcHSrZ8.js").then(o=>o.l),__vite__mapDeps([0,1])).then(o=>{const y=o.default;delete y.Icon.Default.prototype._getIconUrl,y.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"}),M(!0),window.L=y})},[]),n.useEffect(()=>{if(!b||!g.current||l.current)return;const o=window.L;if(o)return console.log("ðŸ—ºï¸ Initializing map..."),l.current=o.map(g.current,{center:[13.7563,100.5018],zoom:12,zoomControl:!1}),o.control.zoom({position:"topleft"}).addTo(l.current),setTimeout(()=>{l.current?.invalidateSize()},200),o.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Â© OpenStreetMap",maxZoom:19}).addTo(l.current),console.log("âœ… Map initialized"),l.current.on("popupopen",y=>{const S=y.popup.getElement().querySelector(".map-popup-preview");S&&(S.onclick=()=>{const A=S.getAttribute("data-id"),m=j.current?.features.find(L=>L.properties.id===A);m&&(console.log("ðŸ¢ Opening detail from popup click:",m.properties.title),x(m.properties))})}),()=>{l.current&&(console.log("ðŸ—‘ï¸ Cleaning up map"),l.current.remove(),l.current=null)}},[b]),n.useEffect(()=>{if(!l.current||!b)return;const o=window.L;if(!o)return;if(u.current.forEach(z=>z.remove()),u.current=[],!s||!s.features||s.features.length===0){console.log("ðŸ“ No markers to display");return}const y=s.features;if(console.log("ðŸ“ Adding",y.length,"markers to map"),y.forEach(z=>{const[S,A]=z.geometry.coordinates,m=z.properties,L=Nt(m.price),q=o.divIcon({className:"custom-map-marker",html:`<div class="marker-pin">${L}</div>`,iconSize:[60,30],iconAnchor:[30,34],popupAnchor:[0,-34]}),T=o.marker([A,S],{icon:q}).bindPopup(`
          <div class="map-popup-preview" data-id="${m.id}">
            <div class="popup-image-container">
              <img src="${m.thumbnail||"https://via.placeholder.com/300x200"}" alt="${m.title}" />
            </div>
            <div class="popup-info">
              <h3 class="popup-title">${m.title}</h3>
              <div class="popup-price">à¸¿${m.price.toLocaleString()}</div>
            </div>
          </div>
        `,{maxWidth:300,className:"custom-property-popup"});T.on("click",()=>{console.log("ðŸ“ Marker clicked:",m.id,m.title),_(m.id);const $=document.getElementById(`property-card-${m.id}`);$&&($.scrollIntoView({behavior:"smooth",block:"center"}),$.classList.add("highlight"),setTimeout(()=>$.classList.remove("highlight"),2e3))}),T.addTo(l.current),u.current.push(T)}),g.current&&g.current.clientWidth>0){const z=o.latLngBounds(y.map(S=>[S.geometry.coordinates[1],S.geometry.coordinates[0]]));l.current.fitBounds(z,{padding:[50,50]})}},[s,b]),n.useEffect(()=>{if(p.current)if(t){const o=p.current;v.set(o,{display:"flex",visibility:"visible",pointerEvents:"auto"}),v.fromTo(o,{y:"100%"},{y:"0%",duration:.6,ease:"power3.out",onComplete:()=>{if(!l.current)return;l.current.invalidateSize();const y=window.L,z=j.current?.features;if(y&&z&&z.length>0){const S=y.latLngBounds(z.map(A=>[A.geometry.coordinates[1],A.geometry.coordinates[0]]));l.current.fitBounds(S,{padding:[50,50]})}}})}else{const o=p.current;v.to(o,{y:"100%",duration:.4,ease:"power2.in",onComplete:()=>{v.set(o,{display:"none",visibility:"hidden",pointerEvents:"none"}),console.log("âœ… Panel closed successfully")}})}},[t]);const R=()=>{p.current&&(f?v.to(p.current,{height:"85vh",duration:.5,ease:"power2.out"}):v.to(p.current,{height:"80px",duration:.5,ease:"power2.out"}),r(!f))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:p,className:`search-panel ${t?"open":""} ${h?"hidden":""}`,children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h2",{children:"Search Results"}),e.jsx("span",{className:"result-count",children:c?"Searching...":`${C.length} properties found`})]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{className:"icon-btn",onClick:R,title:f?"Maximize":"Minimize",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:f?e.jsx("polyline",{points:"18 15 12 9 6 15"}):e.jsx("polyline",{points:"6 9 12 15 18 9"})})}),e.jsx("button",{className:"icon-btn close-btn",onClick:i,title:"Close",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]}),e.jsxs("div",{className:"panel-body",children:[e.jsxs("div",{className:"map-column",children:[e.jsx("div",{ref:g,className:"map-view"}),c&&e.jsxs("div",{className:"map-overlay-message load-overlay",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Searching..."})]})]}),!f&&e.jsx("div",{className:"list-column","data-lenis-prevent":!0,children:c?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading result list..."})]}):C.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),e.jsx("h3",{children:"No Properties Found"}),e.jsx("p",{children:"Try adjusting your filters"})]}):e.jsx("div",{className:"properties-grid",children:C.map(o=>e.jsxs("div",{id:`property-card-${o.id}`,className:`property-card ${N===o.id?"active":""}`,onClick:()=>{console.log("ðŸ–±ï¸ Property card clicked:",o.id,o.title),_(o.id),l.current&&l.current.flyTo([o.lat,o.lng],15),x(o),console.log("âœ… Selected property set:",o)},children:[e.jsxs("div",{className:"card-image-wrapper",children:[e.jsx("img",{src:o.thumbnail||"https://via.placeholder.com/300x200",alt:o.title,className:"property-image"}),e.jsx("div",{className:"card-overlay-top",children:e.jsx("button",{className:"favorite-btn",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})})}),e.jsx("div",{className:"card-overlay-bottom",children:e.jsx("span",{className:"status-badge",children:o.listingType==="sale"?"For Sale":"For Rent"})})]}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"card-price",children:["à¸¿ ",o.price.toLocaleString()]}),e.jsx("h3",{className:"card-title",children:o.title}),e.jsxs("p",{className:"card-location",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),o.address]}),e.jsx("div",{className:"card-divider"}),e.jsxs("div",{className:"card-stats",children:[o.bedrooms>0&&e.jsxs("span",{className:"stat-item",title:"Bedrooms",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M2 4v16"}),e.jsx("path",{d:"M2 8h18a2 2 0 0 1 2 2v10"}),e.jsx("path",{d:"M2 17h20"}),e.jsx("path",{d:"M6 8v9"})]}),o.bedrooms]}),o.bathrooms>0&&e.jsxs("span",{className:"stat-item",title:"Bathrooms",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M9 6 6.5 3.5a1.5 1.5 0 0 0-2.12 0l-.88.88a1.5 1.5 0 0 0 0 2.12l2.5 2.5"}),e.jsx("path",{d:"m21.21 15.89-1.42 1.42a3 3 0 0 0-4.24 0l-5.66 5.66a3 3 0 0 1-4.24-4.24l5.66-5.66a3 3 0 0 0 0-4.24l1.42-1.42a3 3 0 0 1 4.24 0l4.24 4.24a3 3 0 0 1 0 4.24Z"})]}),o.bathrooms]}),o.livingArea&&e.jsxs("span",{className:"stat-item",title:"Living Area",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M3 21h18"}),e.jsx("path",{d:"M5 21V7l8-4 8 4v14"}),e.jsx("path",{d:"M4 10h16"})]}),o.livingArea.toLocaleString()," sqm"]})]}),e.jsxs("div",{className:"card-footer",children:[e.jsxs("label",{className:"compare-check",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:"Share & Compare"})]}),e.jsx("div",{className:"agent-logo",title:o.agent?.name||"Nest Team",children:o.agent?.image_url?e.jsx("img",{src:o.agent.image_url,alt:o.agent.name,className:"w-full h-full object-cover rounded-full"}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#2563eb",strokeWidth:"2",children:[e.jsx("path",{d:"M3 21h18"}),e.jsx("path",{d:"M5 21V7l8-4 8 4v14"}),e.jsx("path",{d:"M9 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4"})]})})]})]})]},o.id))})})]}),e.jsx("style",{children:`
        /* Global & Reset */
        .search-panel {
          position: fixed;
          bottom: 0;
          left: 0;
          right: 0;
          width: 100%;
          height: 85vh;
          background: white;
          border-radius: 24px 24px 0 0;
          box-shadow: 0 -10px 60px rgba(0, 0, 0, 0.3);
          display: none;
          flex-direction: column;
          overflow: hidden;
          z-index: 9999;
          visibility: hidden;
          pointer-events: none;
        }

        .search-panel.hidden {
          display: none !important;
        }
        
        /* Header */
        .panel-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1rem 2rem;
          border-bottom: 1px solid #e2e8f0;
          background: white;
          flex-shrink: 0;
          height: 70px;
        }

        .header-left h2 {
          font-size: 1.5rem;
          font-weight: 800;
          color: #1e293b;
          margin: 0;
        }

        .result-count {
          font-size: 0.875rem;
          color: #64748b;
          font-weight: 600;
        }

        .header-actions {
          display: flex;
          gap: 0.5rem;
        }

        .icon-btn {
          width: 40px;
          height: 40px;
          border: none;
          background: #f1f5f9;
          color: #64748b;
          border-radius: 10px;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all 0.2s;
        }
        .icon-btn:hover { background: #e2e8f0; color: #1e293b; }
        .close-btn:hover { background: #fee2e2; color: #ef4444; }

        /* Split View Layout */
        .panel-body {
          display: flex;
          flex: 1;
          height: calc(100% - 70px);
          overflow: hidden;
        }

        .map-column {
          flex: 1;
          position: relative;
          height: 100%;
          min-width: 0; /* Fix flex overflow */
        }

        .map-view { width: 100%; height: 100%; }

        .list-column {
          width: 450px; /* Fixed width sidebar for list */
          height: 100%;
          overflow-y: auto;
          background: #f8fafc;
          border-left: 1px solid #e2e8f0;
          flex-shrink: 0;
        }

        /* Marker Styles */
        .custom-map-marker {
          background: none; 
          border: none;
        }
        
        .marker-pin {
          background-color: #ef4444; 
          color: white;
          padding: 4px 8px;
          border-radius: 14px;
          font-weight: 700;
          font-size: 13px;
          text-align: center;
          white-space: nowrap;
          box-shadow: 0 2px 6px rgba(0,0,0,0.4);
          border: 2px solid white;
          position: relative;
          cursor: pointer;
          transition: transform 0.2s;
        }
        
        .marker-pin:hover, .marker-pin.active {
          transform: scale(1.1);
          background-color: #dc2626;
          z-index: 999;
        }
        
        /* Triangle indicator for pin */
        .marker-pin::after {
          content: '';
          position: absolute;
          bottom: -5px;
          left: 50%;
          transform: translateX(-50%);
          border-width: 5px 5px 0;
          border-style: solid;
          border-color: white transparent transparent;
        }
        .marker-pin::before {
          content: '';
          position: absolute;
          bottom: -2px; /* Inner color triangle */
          left: 50%;
          transform: translateX(-50%);
          border-width: 4px 4px 0;
          border-style: solid;
          border-color: #ef4444 transparent transparent;
          z-index: 1;
        }
        .marker-pin:hover::before { border-color: #dc2626 transparent transparent; }

        /* Custom Popup Styles */
        .custom-property-popup .leaflet-popup-content-wrapper {
          padding: 0;
          overflow: hidden;
          border-radius: 16px;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .custom-property-popup .leaflet-popup-content {
          margin: 0;
          width: 240px !important;
        }
        .custom-property-popup .leaflet-popup-tip-container {
          display: none;
        }
        .map-popup-preview {
          cursor: pointer;
          background: white;
          transition: all 0.2s;
        }
        .map-popup-preview:hover {
          background: #f8fafc;
        }
        .popup-image-container {
          width: 100%;
          height: 140px;
          overflow: hidden;
        }
        .popup-image-container img {
          width: 100%;
          height: 100%;
          object-fit: cover;
          display: block;
        }
        .popup-info {
          padding: 12px 16px;
        }
        .popup-title {
          font-family: 'Inter', sans-serif;
          font-size: 14px;
          font-weight: 700;
          color: #0f172a;
          margin: 0 0 4px;
          line-height: 1.4;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .popup-price {
          font-family: 'Inter', sans-serif;
          font-size: 16px;
          font-weight: 800;
          color: #2563eb;
        }
        .custom-property-popup .leaflet-popup-close-button {
          top: 8px;
          right: 8px;
          color: white;
          background: rgba(0,0,0,0.4);
          width: 24px;
          height: 24px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 0;
          font-size: 16px;
          transition: background 0.2s;
          border: none;
        }
        .custom-property-popup .leaflet-popup-close-button:hover {
          background: rgba(0,0,0,0.6);
          color: white;
        }

        /* Listing Grid */
        .properties-grid {
          padding: 1.5rem;
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        /* Property Card Design */
        .property-card {
          background: white;
          border: 1px solid #e2e8f0;
          border-radius: 12px;
          overflow: hidden;
          transition: all 0.2s;
          cursor: pointer;
          box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .property-card:hover {
          box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
          transform: translateY(-2px);
          border-color: #cbd5e1;
        }
        .property-card.active, .property-card.highlight {
          border-color: #3b82f6;
          box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .card-image-wrapper {
          position: relative;
          height: 200px;
          overflow: hidden;
        }
        .property-image {
          width: 100%;
          height: 100%;
          object-fit: cover;
          transition: transform 0.3s ease;
        }
        .property-card:hover .property-image {
          transform: scale(1.05);
        }

        .card-overlay-top {
          position: absolute;
          top: 10px;
          right: 10px;
          z-index: 2;
        }
        .favorite-btn {
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: rgba(255,255,255,0.9);
          border: none;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          color: #64748b;
          transition: all 0.2s;
        }
        .favorite-btn:hover { color: #ef4444; background: white; }

        .card-overlay-bottom {
          position: absolute;
          bottom: 10px;
          right: 10px;
          display: flex;
          gap: 8px;
        }
        .status-badge {
          background: #2563eb;
          color: white;
          padding: 4px 10px;
          border-radius: 20px;
          font-size: 0.75rem;
          font-weight: 600;
        }

        .card-content {
          padding: 1rem;
        }
        
        .card-price {
          font-size: 1.25rem;
          font-weight: 700;
          color: #2563eb;
          margin-bottom: 0.25rem;
        }

        .card-title {
          font-size: 1rem;
          font-weight: 600;
          color: #1e293b;
          margin: 0 0 0.25rem;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .card-location {
          font-size: 0.875rem;
          color: #64748b;
          display: flex;
          align-items: center;
          gap: 4px;
          margin-bottom: 0.75rem;
        }
        .card-location svg { color: #94a3b8; }

        .card-divider {
          height: 1px;
          background: #f1f5f9;
          margin: 0.5rem 0;
        }

        .card-stats {
          display: flex;
          gap: 1rem;
          margin-bottom: 1rem;
        }
        .stat-item {
          display: flex;
          align-items: center;
          gap: 4px;
          font-size: 0.8125rem;
          color: #475569;
          font-weight: 500;
        }
        .stat-item svg { color: #94a3b8; width: 14px; height: 14px; }

        .card-footer {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding-top: 0.5rem;
        }

        .compare-check {
          display: flex;
          align-items: center;
          gap: 6px;
          font-size: 0.8125rem;
          color: #64748b;
          cursor: pointer;
        }
        .compare-check input { cursor: pointer; }

        .agent-logo {
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: #eff6ff;
          display: flex;
          align-items: center;
          justify-content: center;
          border: 1px solid #dbeafe;
        }

        /* Loading & Empty States */
        .loading-state, .empty-state {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          height: 100%;
          padding: 2rem;
          text-align: center;
        }
        .spinner {
          width: 36px;
          height: 36px;
          border: 3px solid #f1f5f9;
          border-top-color: #3b82f6;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
          margin-bottom: 1rem;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        .map-overlay-message {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: rgba(255,255,255,0.9);
          padding: 1rem 2rem;
          border-radius: 12px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          border: 1px solid #e2e8f0;
          z-index: 1000;
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .draw-btn-overlay {
          position: absolute;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 400; /* Above map tiles, below some controls */
        }
        
        .draw-btn {
          background: #dc2626;
          color: white;
          border: none;
          padding: 8px 16px;
          border-radius: 20px;
          font-size: 0.875rem;
          font-weight: 500;
          display: flex;
          align-items: center;
          gap: 8px;
          box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
          cursor: pointer;
          transition: transform 0.2s;
        }
        .draw-btn:hover { transform: scale(1.05); }
        .close-draw { margin-left: 8px; font-size: 1.1rem; opacity: 0.8; }
        .close-draw:hover { opacity: 1; }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .panel-body { flex-direction: column; }
          .map-column { height: 50%; }
          .list-column { width: 100%; height: 50%; border-left: none; border-top: 1px solid #e2e8f0; }
        }
      `})]}),h&&e.jsx(kt,{property:h,isOpen:!!h,onClose:()=>x(null)})]})}const zt="http://localhost:8000",Ct="https://zskakdqvjrkwkzzamlkg.supabase.co",St="sb_publishable_VtecDtvgpBBjSgBVEWlQ4g_O68LrugV",Mt="http://localhost:3000",G=Ve(Ct,St),I=t=>{if(!t)return"";if(t.startsWith("http"))return t;const i=t.startsWith("/")?t:`/${t}`;return`${Mt}${i}`};class At{baseURL;constructor(i=zt){this.baseURL=i}async request(i,s={}){const c=`${this.baseURL}${i}`;try{const p=await fetch(c,{...s,headers:{"Content-Type":"application/json",...s.headers}});if(!p.ok)throw new Error(`API Error: ${p.status} ${p.statusText}`);return await p.json()}catch(p){throw console.error("API Request failed:",p),p}}async geocode(i){return this.request(`/api/geocode?address=${encodeURIComponent(i)}`)}async searchProperties(i){let s=G.from("properties").select(`
        *,
        agent:agents (
          id,
          name,
          role,
          phone,
          email,
          lineId:line_id,
          verified,
          bio,
          photo:media (
            url
          )
        ),
        images:properties_images (
          image:media (
            url
          ),
          tag,
          caption
        ),
        thumbnail:media (
          url
        ),
        nearby_places:properties_nearby_places (
          *
        )
      `).eq("status","active");if(i.listingType&&(s=s.eq("listing_type",i.listingType)),i.propertyType){const r=i.propertyType.split(",").map(N=>N.trim());r.length>1?s=s.in("property_type",r):s=s.eq("property_type",r[0])}i.priceMin&&(s=s.gte("price",i.priceMin)),i.priceMax&&(s=s.lte("price",i.priceMax)),i.pet_friendly&&(s=s.eq("details->pet_friendly",!0)),i.bedrooms&&i.bedrooms!=="any"&&(i.bedrooms==="4+"?s=s.gte("stats->bedrooms",4):s=s.eq("stats->bedrooms",parseInt(i.bedrooms))),i.bathrooms&&i.bathrooms!=="any"&&(i.bathrooms==="4+"?s=s.gte("stats->bathrooms",4):s=s.eq("stats->bathrooms",parseInt(i.bathrooms))),i.location&&(s=s.or(`title.ilike.%${i.location}%,address.ilike.%${i.location}%,project_name.ilike.%${i.location}%`)),i.livingAreaMin&&(s=s.gte("stats->livingArea",i.livingAreaMin)),i.livingAreaMax&&(s=s.lte("stats->livingArea",i.livingAreaMax));const{data:c,error:p}=await s;return p?(console.error("Supabase search error:",p),{type:"FeatureCollection",features:[]}):{type:"FeatureCollection",features:(c||[]).map(r=>{const _=r.thumbnail?.url||"",h=(r.images||[]).map(j=>j.image?.url).filter(Boolean),x=r.lat??r.location?.lat??13.7563,g=r.lng??r.location?.lng??100.5018,l=r.stats||{},u=r.details||{},b=r.agent,M=b?{id:b.id?.toString(),name:b.name,role:b.role||"Agent",image_url:I(b.photo?.url),phone:b.phone,email:b.email,lineId:b.lineId,verified:b.verified}:void 0;return M?.image_url,{type:"Feature",geometry:{type:"Point",coordinates:[g,x]},properties:{id:r.id?.toString(),title:r.title,description:r.description||"",address:r.address||r.location?.province||"",price:r.price||0,bedrooms:l.bedrooms||0,bathrooms:l.bathrooms||0,livingArea:l.livingArea||0,landArea:l.landArea||0,sqft:l.livingArea||0,yearBuilt:l.yearBuilt,floors:l.floors,parking:l.parking,propertyType:r.property_type||"Unknown",listingType:r.listing_type||"sale",thumbnail:I(_),images:h.length>0?h.map(j=>I(j)):[I(_)],lng:g,lat:x,location:r.location,project_name:r.project_name,direction:u.direction,ownership:u.ownership,common_fee:u.common_fee,decoration:u.decoration,pet_friendly:u.pet_friendly||!1,view_count:r.view_count||0,updatedAt:r.updated_at,createdAt:r.created_at,featured:r.featured,rating:0,indoor_amenities:r.indoor_amenities||{},project_amenities:r.project_amenities||{},amenities:[],nearby_places:(r.nearby_places||[]).map(j=>({id:j.id,name:j.name,distance:j.distance,category:j.category,icon:j.icon})),agent:M}}})}}async getNearbyProperties(i,s,c=5){return[]}async getProperty(i){const{data:s,error:c}=await G.from("properties").select(`
        *,
        agent:agents (
          id,
          name,
          role,
          phone,
          email,
          lineId:line_id,
          verified,
          bio,
          photo:media (
            url
          )
        ),
        images:properties_images (
          image:media (
            url
          ),
          tag,
          caption
        ),
        thumbnail:media (
          url
        ),
        nearby_places:properties_nearby_places (
          *
        )
      `).eq("id",i).single();if(c||!s)return console.error("Error fetching property:",c),null;const f=s.thumbnail?.url||"",r=(s.images||[]).map(u=>u.image?.url).filter(Boolean),N=s.location?.lat??s.location_lat??13.7563,_=s.location?.lng??s.location_lng??100.5018,h=s.stats||{},x=s.details||{},g=s.agent,l=g?{id:g.id?.toString(),name:g.name,role:g.role||"Agent",image_url:I(g.photo?.url),phone:g.phone,email:g.email,lineId:g.lineId,verified:g.verified}:void 0;return l?.image_url,{id:s.id?.toString(),title:s.title,description:s.description||"",address:s.address||"",price:s.price||0,bedrooms:h.bedrooms||0,bathrooms:h.bathrooms||0,livingArea:h.livingArea||0,sqft:h.livingArea||0,landArea:h.landArea||0,yearBuilt:h.yearBuilt,floors:h.floors,parking:h.parking,propertyType:s.property_type||"Unknown",listingType:s.listing_type||"sale",thumbnail:I(f),images:r.length>0?r.map(u=>I(u)):[I(f)],lng:_,lat:N,location:s.location,project_name:s.project_name,direction:x.direction,ownership:x.ownership,common_fee:x.common_fee,decoration:x.decoration,view_count:s.view_count||0,updatedAt:s.updated_at,createdAt:s.created_at,featured:s.featured,indoor_amenities:s.indoor_amenities||{},project_amenities:s.project_amenities||{},amenities:[],nearby_places:(s.nearby_places||[]).map(u=>({id:u.id,name:u.name,distance:u.distance,category:u.category,icon:u.icon})),agent:l}}async getFeaturedProperties(){const{data:i,error:s}=await G.from("properties").select(`
        *,
        thumbnail:media ( url ),
        location
      `).eq("featured",!0).eq("status","active").limit(6);return s?[]:i.map(c=>({id:c.id.toString(),title:c.title,price:c.price,address:c.address,thumbnail:I(c.thumbnail?.url),bedrooms:c.stats?.bedrooms||0,bathrooms:c.stats?.bathrooms||0,livingArea:c.stats?.livingArea||0,propertyType:c.property_type||"Unknown",listingType:c.listing_type||"sale",lat:c.location?.lat||13.7563,lng:c.location?.lng||100.5018}))}}const Lt=new At;function Zt(){const[t,i]=n.useState(!1),[s,c]=n.useState(!1),[p,f]=n.useState(null);return n.useEffect(()=>{const r=async N=>{const _=N,{filters:h}=_.detail;console.log("ðŸ” Opening search panel with filters:",h),i(!0),c(!0),f(null);try{console.log("ðŸ“¡ Calling API...");const x=await Lt.searchProperties(h);console.log("âœ… API Response:",x),!x||!x.features?f({type:"FeatureCollection",features:[]}):f(x)}catch(x){console.error("âŒ Search failed:",x),f({type:"FeatureCollection",features:[]})}finally{c(!1),console.log("âœ… Panel should be open now")}};return window.addEventListener("openSearchModal",r),()=>{window.removeEventListener("openSearchModal",r)}},[]),e.jsx(_t,{isOpen:t,onClose:()=>i(!1),searchResults:p,isLoading:s})}export{Zt as default};
